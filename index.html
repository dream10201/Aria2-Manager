<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aria2 Pro Manager</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Icons -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        dark: '#0f172a',
                        card: '#1e293b'
                    }
                }
            }
        }
    </script>
    <style>
        [v-cloak] { display: none; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
        
        /* Custom Checkbox Animation */
        .check-enter-active, .check-leave-active { transition: all 0.3s ease; }
        .check-enter-from, .check-leave-to { transform: translateY(100%); opacity: 0; }
    </style>
</head>
<body class="bg-dark text-gray-200 font-sans min-h-screen selection:bg-primary selection:text-white pb-24">

<div id="app" v-cloak class="container mx-auto px-4 py-6 max-w-5xl relative">
    
    <!-- Header -->
    <header class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/20 transition-all" :class="{'opacity-50 grayscale': !connected}">
                <i class="ri-download-cloud-2-line text-xl text-white"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold tracking-tight">Aria2 Manager <span class="text-xs font-normal text-gray-500 bg-gray-800 px-1 rounded ml-1">Pro</span></h1>
                <div class="flex gap-3 text-xs text-gray-400 font-mono">
                    <span :class="{'text-green-400': connected, 'text-red-400': !connected, 'animate-pulse': connecting}">
                        ● {{ statusText }}
                    </span>
                    <span v-if="version">v{{ version }}</span>
                </div>
            </div>
        </div>

        <div class="flex gap-4 w-full md:w-auto">
            <div class="bg-card px-4 py-2 rounded-lg border border-gray-700/50 flex-1 md:flex-none">
                <div class="text-xs text-gray-500 uppercase">下载</div>
                <div class="text-lg font-bold text-green-400 font-mono">{{ formatSize(globalStat.downloadSpeed) }}/s</div>
            </div>
            <div class="bg-card px-4 py-2 rounded-lg border border-gray-700/50 flex-1 md:flex-none">
                <div class="text-xs text-gray-500 uppercase">上传</div>
                <div class="text-lg font-bold text-blue-400 font-mono">{{ formatSize(globalStat.uploadSpeed) }}/s</div>
            </div>
            <button @click="showSettings = true" class="bg-card hover:bg-gray-700 w-12 rounded-lg border border-gray-700/50 transition-colors">
                <i class="ri-settings-3-line text-xl"></i>
            </button>
        </div>
    </header>

    <!-- Toolbar -->
    <div class="flex flex-wrap items-center gap-2 mb-4">
        <!-- Tabs -->
        <div class="flex bg-card p-1 rounded-lg border border-gray-700/50">
            <button @click="switchTab('active')" :class="currentTab === 'active' ? 'bg-primary text-white shadow' : 'text-gray-400 hover:text-gray-200'" class="px-3 py-1.5 rounded-md text-sm font-medium transition-all">
                进行中 <span v-if="activeTasks.length" class="ml-1 opacity-70 bg-black/20 px-1.5 rounded-full text-xs">{{ activeTasks.length }}</span>
            </button>
            <button @click="switchTab('waiting')" :class="currentTab === 'waiting' ? 'bg-primary text-white shadow' : 'text-gray-400 hover:text-gray-200'" class="px-3 py-1.5 rounded-md text-sm font-medium transition-all">
                等待中 <span v-if="waitingTasks.length" class="ml-1 opacity-70 bg-black/20 px-1.5 rounded-full text-xs">{{ waitingTasks.length }}</span>
            </button>
            <button @click="switchTab('stopped')" :class="currentTab === 'stopped' ? 'bg-primary text-white shadow' : 'text-gray-400 hover:text-gray-200'" class="px-3 py-1.5 rounded-md text-sm font-medium transition-all">
                已完成 <span v-if="stoppedTasks.length" class="ml-1 opacity-70 bg-black/20 px-1.5 rounded-full text-xs">{{ stoppedTasks.length }}</span>
            </button>
        </div>

        <div class="flex-grow"></div>
        
        <!-- Add Button -->
        <button @click="showAddModal = true" class="bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-lg shadow-blue-500/20 transition-all flex items-center gap-2">
            <i class="ri-add-line"></i> 新建
        </button>
    </div>

    <!-- Selection Toolbar (Select All) -->
    <div v-if="currentList.length > 0" class="flex items-center mb-2 px-2 text-sm text-gray-400 select-none">
        <div @click="toggleSelectAll" class="flex items-center gap-2 cursor-pointer hover:text-white transition-colors">
            <i :class="isAllSelected ? 'ri-checkbox-circle-fill text-primary' : 'ri-checkbox-blank-circle-line'" class="text-xl"></i>
            <span>全选当前列表</span>
        </div>
    </div>

    <!-- Task List -->
    <div class="space-y-3">
        <div v-if="!connected" class="text-center py-10 bg-card rounded-xl border border-red-900/30 border-dashed">
            <i class="ri-wifi-off-line text-4xl text-red-500/50 mb-2 block"></i>
            <span class="text-gray-500">连接断开，正在尝试重连...</span>
        </div>

        <div v-else-if="currentList.length === 0" class="text-center py-20 bg-card rounded-xl border border-gray-700/30 border-dashed">
            <i class="ri-inbox-line text-4xl text-gray-600 mb-2 block"></i>
            <span class="text-gray-500">暂无任务</span>
        </div>

        <div v-else v-for="task in currentList" :key="task.gid" 
             class="bg-card rounded-xl p-4 border transition-all duration-200 group relative overflow-hidden"
             :class="selectedGids.has(task.gid) ? 'border-primary bg-primary/5' : 'border-gray-700/50 hover:border-gray-600'"
             @click.stop="toggleSelection(task.gid)">
            
            <!-- Selection Overlay (Click Area) -->
            <div class="flex justify-between items-start gap-4">
                <!-- Checkbox -->
                <div class="pt-1">
                    <i :class="selectedGids.has(task.gid) ? 'ri-checkbox-circle-fill text-primary' : 'ri-checkbox-blank-circle-line text-gray-600 group-hover:text-gray-400'" class="text-xl transition-colors"></i>
                </div>

                <!-- Info -->
                <div class="flex-1 min-w-0">
                    <h3 class="font-medium text-sm md:text-base truncate text-gray-200" :title="getTaskName(task)">
                        <i v-if="task.bittorrent" class="ri-share-forward-line text-primary mr-1"></i>
                        {{ getTaskName(task) }}
                    </h3>
                    <div class="text-xs text-gray-500 mt-1 truncate font-mono">
                        {{ task.dir }}
                    </div>
                </div>

                <!-- Single Actions -->
                <div class="flex gap-1 z-10" @click.stop>
                    <button v-if="task.status === 'active'" @click="sendAction('pause', task.gid)" class="p-1.5 hover:bg-gray-700 rounded text-yellow-400" title="暂停">
                        <i class="ri-pause-line"></i>
                    </button>
                    <button v-if="task.status === 'paused'" @click="sendAction('unpause', task.gid)" class="p-1.5 hover:bg-gray-700 rounded text-green-400" title="开始">
                        <i class="ri-play-line"></i>
                    </button>
                    <!-- Stop propagation to prevent selection toggle when clicking delete -->
                    <button @click="sendAction('remove', task.gid)" class="p-1.5 hover:bg-gray-700 rounded text-red-400" title="删除">
                        <i class="ri-delete-bin-line"></i>
                    </button>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="h-1.5 w-full bg-gray-700 rounded-full overflow-hidden my-3 ml-9 w-[calc(100%-2.25rem)]">
                <div class="h-full bg-gradient-to-r from-blue-500 to-cyan-400 transition-all duration-500"
                     :style="{width: getProgress(task) + '%', opacity: task.status === 'active' ? 1 : 0.5}"></div>
            </div>

            <!-- Meta Data -->
            <div class="flex flex-wrap justify-between items-end text-xs text-gray-400 font-mono ml-9">
                <div class="flex gap-4">
                    <span><i class="ri-file-size-line mr-1"></i>{{ formatSize(task.completedLength) }} / {{ formatSize(task.totalLength) }}</span>
                    <span><i class="ri-percent-line mr-1"></i>{{ getProgress(task) }}%</span>
                </div>
                <div class="flex gap-4 items-center">
                    <span v-if="task.status === 'active'" class="text-green-400">
                        <i class="ri-speed-line mr-1"></i>{{ formatSize(task.downloadSpeed) }}/s
                    </span>
                    <span v-if="task.status === 'error'" class="text-red-400">
                        Err: {{ task.errorCode }}
                    </span>
                    <span class="bg-gray-700 px-2 py-0.5 rounded text-[10px] uppercase">{{ task.status }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Batch Actions Floating Bar -->
    <transition name="check">
        <div v-if="selectedGids.size > 0" class="fixed bottom-6 left-0 right-0 px-4 flex justify-center z-40">
            <div class="bg-gray-800/90 backdrop-blur-md border border-gray-600 text-white px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-6">
                <span class="font-medium text-sm text-gray-300">已选 {{ selectedGids.size }} 项</span>
                <div class="h-6 w-px bg-gray-600"></div>
                <div class="flex gap-2">
                    <button v-if="currentTab !== 'stopped'" @click="executeBatch('unpause')" class="flex items-center gap-1 hover:text-green-400 transition-colors" title="批量开始">
                        <i class="ri-play-circle-line text-xl"></i> <span class="text-xs">开始</span>
                    </button>
                    <button v-if="currentTab !== 'stopped'" @click="executeBatch('pause')" class="flex items-center gap-1 hover:text-yellow-400 transition-colors" title="批量暂停">
                        <i class="ri-pause-circle-line text-xl"></i> <span class="text-xs">暂停</span>
                    </button>
                    <button @click="executeBatch('remove')" class="flex items-center gap-1 hover:text-red-400 transition-colors" title="批量删除">
                        <i class="ri-delete-bin-line text-xl"></i> <span class="text-xs">删除</span>
                    </button>
                </div>
                <button @click="selectedGids.clear()" class="ml-2 text-gray-500 hover:text-white">
                    <i class="ri-close-line text-xl"></i>
                </button>
            </div>
        </div>
    </transition>

    <!-- Add Task Modal (Same as before) -->
    <div v-if="showAddModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4" @click.self="showAddModal = false">
        <div class="bg-card w-full max-w-lg rounded-xl border border-gray-700 shadow-2xl p-6 transform transition-all">
            <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                <i class="ri-add-circle-line text-primary"></i> 新建下载
            </h2>
            <div class="flex border-b border-gray-700 mb-4">
                <button @click="addMode = 'url'" :class="addMode === 'url' ? 'border-primary text-primary' : 'border-transparent text-gray-400 hover:text-gray-200'" class="pb-2 px-4 border-b-2 font-medium text-sm transition-colors">链接下载</button>
                <button @click="addMode = 'torrent'" :class="addMode === 'torrent' ? 'border-primary text-primary' : 'border-transparent text-gray-400 hover:text-gray-200'" class="pb-2 px-4 border-b-2 font-medium text-sm transition-colors">BT 种子文件</button>
            </div>
            <div v-if="addMode === 'url'">
                <textarea v-model="newUris" placeholder="请输入下载链接，每行一个" class="w-full h-32 bg-dark border border-gray-700 rounded-lg p-3 text-sm focus:outline-none focus:border-primary resize-none mb-1 font-mono"></textarea>
            </div>
            <div v-if="addMode === 'torrent'">
                <div class="w-full h-32 border-2 border-dashed border-gray-600 hover:border-primary hover:bg-dark/50 rounded-lg flex flex-col items-center justify-center cursor-pointer transition-colors relative">
                    <input type="file" accept=".torrent" @change="handleFileSelect" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                    <i class="ri-file-upload-line text-3xl mb-2 text-gray-500"></i>
                    <p class="text-sm text-gray-400" v-if="!selectedFile">点击或拖拽 .torrent 文件</p>
                    <p class="text-sm text-primary font-bold" v-else>{{ selectedFile.name }}</p>
                </div>
            </div>
            <div class="flex justify-end gap-3 mt-4">
                <button @click="showAddModal = false" class="px-4 py-2 rounded-lg text-sm text-gray-400 hover:text-white transition-colors">取消</button>
                <button @click="executeAddTask" :disabled="!canSubmit || !connected" :class="(canSubmit && connected) ? 'bg-primary hover:bg-blue-600 text-white' : 'bg-gray-700 text-gray-500 cursor-not-allowed'" class="px-4 py-2 rounded-lg text-sm font-medium transition-colors">立即下载</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div v-if="showSettings" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4" @click.self="showSettings = false">
        <div class="bg-card w-full max-w-md rounded-xl border border-gray-700 shadow-2xl p-6">
            <h2 class="text-lg font-bold mb-4 flex items-center gap-2"><i class="ri-server-line text-primary"></i> 服务器设置</h2>
            <div class="space-y-4">
                <div><label class="block text-xs text-gray-500 mb-1">Host</label><input v-model="config.host" type="text" class="w-full bg-dark border border-gray-700 rounded-lg p-2 text-sm"></div>
                <div><label class="block text-xs text-gray-500 mb-1">Port</label><input v-model="config.port" type="number" class="w-full bg-dark border border-gray-700 rounded-lg p-2 text-sm"></div>
                <div><label class="block text-xs text-gray-500 mb-1">RPC Secret</label><input v-model="config.secret" type="password" class="w-full bg-dark border border-gray-700 rounded-lg p-2 text-sm"></div>
                <div class="flex items-center gap-2"><input type="checkbox" id="ssl" v-model="config.ssl" class="rounded bg-dark border-gray-700 text-primary focus:ring-0"><label for="ssl" class="text-sm text-gray-400">启用 SSL (WSS)</label></div>
            </div>
            <div class="mt-6 flex justify-end"><button @click="saveAndReconnect" class="px-4 py-2 bg-primary hover:bg-blue-600 text-white rounded-lg text-sm font-medium w-full">保存并重连</button></div>
        </div>
    </div>

</div>

<script>
    const { createApp, ref, computed, onMounted, onUnmounted } = Vue

    createApp({
        setup() {
            // -- Config --
            const config = ref({
                host: localStorage.getItem('aria2_host') || 'localhost',
                port: localStorage.getItem('aria2_port') || '6800',
                secret: localStorage.getItem('aria2_secret') || '',
                ssl: localStorage.getItem('aria2_ssl') === 'true'
            })

            // -- App State --
            const connected = ref(false)
            const connecting = ref(true)
            const version = ref('')
            const globalStat = ref({ downloadSpeed: 0, uploadSpeed: 0, numActive: 0, numWaiting: 0, numStopped: 0 })
            const activeTasks = ref([])
            const waitingTasks = ref([])
            const stoppedTasks = ref([])
            const statusText = ref('连接中...')

            // -- WebSocket --
            let socket = null
            let pollInterval = null
            const RECONNECT_DELAY = 3000

            // -- UI State --
            const currentTab = ref('active')
            const showAddModal = ref(false)
            const showSettings = ref(false)
            const addMode = ref('url')
            const newUris = ref('')
            const selectedFile = ref(null)
            
            // -- Batch Selection State --
            const selectedGids = ref(new Set())

            // Computed
            const currentList = computed(() => {
                if (currentTab.value === 'active') return activeTasks.value
                if (currentTab.value === 'waiting') return waitingTasks.value
                return stoppedTasks.value
            })

            const canSubmit = computed(() => {
                if (addMode.value === 'url') return newUris.value.trim().length > 0
                if (addMode.value === 'torrent') return selectedFile.value !== null
                return false
            })

            const isAllSelected = computed(() => {
                if (currentList.value.length === 0) return false
                return currentList.value.every(task => selectedGids.value.has(task.gid))
            })

            // -- Methods --

            const switchTab = (tab) => {
                currentTab.value = tab
                selectedGids.value.clear() // Clear selection on tab switch
            }

            const toggleSelection = (gid) => {
                if (selectedGids.value.has(gid)) selectedGids.value.delete(gid)
                else selectedGids.value.add(gid)
            }

            const toggleSelectAll = () => {
                if (isAllSelected.value) {
                    selectedGids.value.clear()
                } else {
                    currentList.value.forEach(task => selectedGids.value.add(task.gid))
                }
            }

            // -- WS Logic --
            const buildRpcMessage = (method, params = [], id = null) => {
                const finalParams = config.value.secret ? [`token:${config.value.secret}`, ...params] : params
                return JSON.stringify({
                    jsonrpc: '2.0',
                    id: id || 'req-' + Date.now(),
                    method: `aria2.${method}`,
                    params: finalParams
                })
            }

            const initWebSocket = () => {
                if (socket) socket.close()
                connecting.value = true
                statusText.value = '连接中...'
                const protocol = config.value.ssl ? 'wss' : 'ws'
                const url = `${protocol}://${config.value.host}:${config.value.port}/jsonrpc`

                socket = new WebSocket(url)

                socket.onopen = () => {
                    connected.value = true
                    connecting.value = false
                    statusText.value = '已连接'
                    socket.send(buildRpcMessage('getVersion', [], 'sys_version'))
                    pollInterval = setInterval(sendPollRequest, 1000)
                    sendPollRequest()
                }

                socket.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data)
                        handleResponse(data)
                    } catch (e) { console.error(e) }
                }

                socket.onclose = () => handleDisconnect()
                socket.onerror = (e) => console.error(e)
            }

            const handleDisconnect = () => {
                connected.value = false
                connecting.value = true
                statusText.value = '断开重连...'
                if (pollInterval) clearInterval(pollInterval)
                setTimeout(() => { if (!connected.value) initWebSocket() }, RECONNECT_DELAY)
            }

            const sendPollRequest = () => {
                if (!connected.value) return
                const fields = ['gid', 'status', 'totalLength', 'completedLength', 'downloadSpeed', 'uploadSpeed', 'dir', 'files', 'bittorrent', 'errorCode']
                const secret = config.value.secret ? `token:${config.value.secret}` : null
                const calls = [
                    { methodName: 'aria2.getGlobalStat', params: secret ? [secret] : [] },
                    { methodName: 'aria2.tellActive', params: secret ? [secret, fields] : [fields] },
                    { methodName: 'aria2.tellWaiting', params: secret ? [secret, 0, 1000, fields] : [0, 1000, fields] },
                    { methodName: 'aria2.tellStopped', params: secret ? [secret, 0, 1000, fields] : [0, 1000, fields] }
                ]
                socket.send(JSON.stringify({ jsonrpc: '2.0', id: 'poll_update', method: 'system.multicall', params: [calls] }))
            }

            const handleResponse = (data) => {
                if (data.id === 'poll_update' && data.result) {
                    const [resGlobal, resActive, resWaiting, resStopped] = data.result
                    if (resGlobal && resGlobal.length > 0) globalStat.value = resGlobal[0]
                    if (resActive && resActive.length > 0) activeTasks.value = resActive[0]
                    if (resWaiting && resWaiting.length > 0) waitingTasks.value = resWaiting[0]
                    if (resStopped && resStopped.length > 0) stoppedTasks.value = resStopped[0]
                    
                    // Cleanup selection if task disappeared
                    const allGids = new Set([...activeTasks.value, ...waitingTasks.value, ...stoppedTasks.value].map(t => t.gid))
                    for (const gid of selectedGids.value) {
                        if (!allGids.has(gid)) selectedGids.value.delete(gid)
                    }
                }
                else if (data.id === 'sys_version') version.value = data.result.version
                else if (data.id === 'task_action' || data.id === 'batch_action') sendPollRequest()
            }

            // -- Actions --
            const sendAction = (action, gid) => {
                let method = `aria2.${action}`
                if (currentTab.value === 'stopped' && action === 'remove') method = 'aria2.removeDownloadResult'
                socket.send(buildRpcMessage(method.replace('aria2.', ''), [gid], 'task_action'))
            }

            // 核心：批量操作逻辑
            const executeBatch = (action) => {
                if (selectedGids.value.size === 0) return
                if (!confirm(`确定要对选中的 ${selectedGids.value.size} 个任务执行操作吗？`)) return

                const secret = config.value.secret ? `token:${config.value.secret}` : null
                let method = `aria2.${action}`
                
                // 对“已完成/停止”的任务，删除操作对应 removeDownloadResult
                if (currentTab.value === 'stopped' && action === 'remove') {
                    method = 'aria2.removeDownloadResult'
                }

                const calls = Array.from(selectedGids.value).map(gid => {
                    const params = secret ? [secret, gid] : [gid]
                    return { methodName: method, params: params }
                })

                socket.send(JSON.stringify({
                    jsonrpc: '2.0',
                    id: 'batch_action',
                    method: 'system.multicall',
                    params: [calls]
                }))
                
                selectedGids.value.clear()
            }

            const executeAddTask = () => {
                /* Same as before logic */
                if (addMode.value === 'url') {
                    const uris = newUris.value.split('\n').filter(u => u.trim())
                    uris.forEach(uri => socket.send(buildRpcMessage('addUri', [[uri.trim()]], 'task_add')))
                    newUris.value = ''
                } else if (addMode.value === 'torrent' && selectedFile.value) {
                    const reader = new FileReader()
                    reader.onload = (e) => {
                        const base64 = e.target.result.split(',')[1]
                        socket.send(buildRpcMessage('addTorrent', [base64], 'task_add'))
                    }
                    reader.readAsDataURL(selectedFile.value)
                    selectedFile.value = null
                }
                showAddModal.value = false
                setTimeout(sendPollRequest, 500)
            }

            const handleFileSelect = (e) => {
                const file = e.target.files[0]
                if (file && file.name.endsWith('.torrent')) selectedFile.value = file
                else alert('请选择 .torrent 文件')
                e.target.value = ''
            }

            const saveAndReconnect = () => {
                localStorage.setItem('aria2_host', config.value.host)
                localStorage.setItem('aria2_port', config.value.port)
                localStorage.setItem('aria2_secret', config.value.secret)
                localStorage.setItem('aria2_ssl', config.value.ssl)
                showSettings.value = false
                initWebSocket()
            }

            const formatSize = (bytes) => {
                bytes = Number(bytes); if (bytes === 0) return '0 B'
                const k = 1024, sizes = ['B', 'KB', 'MB', 'GB', 'TB']
                const i = Math.floor(Math.log(bytes) / Math.log(k))
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]
            }
            const getProgress = (t) => t.totalLength == 0 ? 0 : ((t.completedLength / t.totalLength) * 100).toFixed(2)
            const getTaskName = (t) => {
                if (t.bittorrent?.info?.name) return t.bittorrent.info.name
                if (t.files?.[0]?.path) return t.files[0].path.split('/').pop()
                if (t.files?.[0]?.uris?.[0]?.uri) return t.files[0].uris[0].uri.split('/').pop()
                return '未知任务'
            }

            onMounted(() => initWebSocket())
            onUnmounted(() => {
                if (socket) socket.close()
                if (pollInterval) clearInterval(pollInterval)
            })

            return {
                config, connected, connecting, statusText, version, globalStat,
                currentTab, currentList, activeTasks, waitingTasks, stoppedTasks,
                showAddModal, showSettings, addMode, newUris, selectedFile, canSubmit,
                // Selection
                selectedGids, isAllSelected, toggleSelection, toggleSelectAll, switchTab, executeBatch,
                // Others
                formatSize, getProgress, getTaskName, handleFileSelect,
                sendAction, executeAddTask, saveAndReconnect
            }
        }
    }).mount('#app')
</script>
</body>
</html>
